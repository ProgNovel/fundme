"use strict";function isMultiplePointer(e){return Array.isArray(e)}function setWebMonetizationPointer(e){return setWebMonetizationTag(document.querySelector('meta[name="monetization"]'),e)}function setWebMonetizationTag(e,t){return e?e.content=t:e=createWebMonetizationTag(t),e}function createWebMonetizationTag(e){var t=document.createElement("meta");return t.name="monetization",t.content=e,document.head.appendChild(t),t}function getPoolWeightSum(e){var t=e.map(function(e){return e.weight});return Object.values(t).reduce(function(e,t){return e+t},0)}function getWinningPointer(e,t){for(var n in e){if((t-=e[n].weight)<=0)return e[n]}}function setPointerSingle(e){setWebMonetizationPointer(e)}Object.defineProperty(exports,"__esModule",{value:!0});var defaultAddressNotFound="Fundme.js: default address not found. Use setDefaultAddress(str: string) to set it first.",invalidAddress="Fundme.js: Invalid Web Monetization pointer address is given.",addressNotFound="Fundme.js: address not found.",addressIsNotAString="Fundme.js: address must be a string.";function weightIsNotANumber(e){return"Fundme.js: "+e+" has weight that is not a number. It has been set to "+DEFAULT_WEIGHT+" (default)."}var DEFAULT_WEIGHT=5;function setPointerMultiple(e,t){setWebMonetizationPointer(getPointerAddress(pickPointer(createPool(e))))}function getPointerAddress(e){var t=e.address;if(!t)throw new Error(addressNotFound);if("string"!=typeof t)throw new Error(addressIsNotAString);return t}function createPool(e){return e.map(function(e){if("string"==typeof e&&(e=convertToPointer(e)),!("address"in e))throw new Error(addressNotFound);return checkWeight(e)})}function checkWeight(e){return void 0!==e.weight&&NaN!==e.weight||(console.warn(weightIsNotANumber(e.address)),e.weight=DEFAULT_WEIGHT),e}function pickPointer(e){return getWinningPointer(e,getChoice(getPoolWeightSum(e)))}function getChoice(e){return Math.random()*e}function convertToPointer(e){return{address:e,weight:DEFAULT_WEIGHT}}var FundType,defaultAddress=void 0;function fund(e,t){if("string"==typeof e){if("default"===e){if(void 0!==defaultAddress)return"string"==typeof defaultAddress?setPointerSingle(defaultAddress):setPointerMultiple(defaultAddress),FundType.isDefault;throw new Error(defaultAddressNotFound)}return setPointerSingle(e),FundType.isSingle}if(isMultiplePointer(e))return setPointerMultiple(e),FundType.isMultiple;if(void 0===e)return FundType.isFromTemplate;throw new Error(invalidAddress)}function setDefaultAddress(e){defaultAddress=e}!function(e){e.isSingle="single",e.isMultiple="multiple",e.isDefault="default",e.isFromTemplate="template",e.isUndefined="undefined"}(FundType||(FundType={})),exports.fund=fund,exports.setDefaultAddress=setDefaultAddress;
