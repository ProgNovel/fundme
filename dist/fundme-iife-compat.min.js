"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var n=0,r=Array(t.length);n<t.length;n++)r[n]=t[n];return r}return Array.from(t)}var fundme=function(t){function n(t){return function(t,n){t?t.content=n:t=function(t){var n=document.createElement("meta");return n.name="monetization",n.content=t,document.head.appendChild(n),n}(n);return t}(document.querySelector('meta[name="monetization"]'),t)}function r(t){n(t)}var e="Fundme.js: default address not found. Use setDefaultAddress(str: string) to set it first.",i="Fundme.js: Invalid Web Monetization pointer address is given.",o="Fundme.js: address not found.",a="Fundme.js: address must be a string.";var u="Fundme.js: no monetization template is found.",s="Fundme.js: fails to parse address from <template data-fund></template>.",d="Fundme.js: cannot parse JSON from <script fundme>. Make sure it contains a valid JSON.",f="Fundme.js: found <script fundme> but it's not an array.",c='Fundme.js: found <script fundme> but its type is not "application/json"',l=5;function m(t){n(function(t){var n=t.address;if(!n)throw new Error(o);if("string"!=typeof n)throw new Error(a);return n}(function(t){var n=function(t){return Math.random()*t}(function(t){var n=t.map(function(t){return t.weight});return Object.values(n).reduce(function(t,n){return t+n},0)}(t));return function(t,n){for(var r in t)if((n-=t[r].weight)<=0)return t[r]}(t,n)}(p(t))))}function p(t){return t.map(function(t){if("string"==typeof t&&(t=function(t){var n=t,r=void 0,e=t.split("#");e.length>1&&(n=e[0],r=parseInt(e[1],10));return{address:n,weight:r||l}}(t)),!("address"in t))throw new Error(o);return h(t)})}function h(t){return void 0!==t.weight&&NaN!==t.weight||(console.warn("Fundme.js: "+t.address+" has weight that is not a number. It has been set to "+l+" (default)."),t.weight=l),t}var v="template[data-fund]",w="script[fundme]";function y(){var t=[].concat(_toConsumableArray(function(){var t=document.body.querySelectorAll(v),n=[];t.length&&t.forEach(function(t){var r=function(t){var n=t.dataset.fund,r=void 0!==t.dataset.fundWeight?parseInt(t.dataset.fundWeight,0):l;if(!n)throw new Error(s);return h({address:n,weight:r})}(t);n=[].concat(_toConsumableArray(n),[r])});return n}()),_toConsumableArray(function(){var t=document.body.querySelectorAll(w),n=[];t.length&&t.forEach(function(t){n=function(t){var n=[],r=void 0;try{r=JSON.parse(t.innerHTML)}catch(t){throw new Error(d)}if("application/json"!==t.type)throw new Error(c);if(Array.isArray(r))n=p(r);else{if("string"!=typeof r)throw new Error(f);n=p([r])}return n}(t)});return n}()));if(!t.length)throw new Error(u);m(t)}var g,A=void 0;function b(t){return t}return function(t){t.isSingle="single",t.isMultiple="multiple",t.isDefault="default",t.isFromTemplate="template",t.isUndefined="undefined"}(g||(g={})),t.fund=function(t,n){if("string"==typeof t){if("default"===t){if(void 0!==A)return"string"==typeof A?r(A):m(A),b(g.isDefault);throw new Error(e)}return r(t),b(g.isSingle)}if(o=t,Array.isArray(o))return m(t),b(g.isMultiple);var o;if(void 0===t)return y(),b(g.isFromTemplate);throw new Error(i)},t.setDefaultAddress=function(t){A=Array.isArray(t)?p(t):t},t}({});
