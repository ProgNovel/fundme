"use strict";function _toConsumableArray(r){if(Array.isArray(r)){for(var t=0,n=Array(r.length);t<r.length;t++)n[t]=r[t];return n}return Array.from(r)}var fundme=function(r){function t(r){return function(r,t){r?r.content=t:r=function(r){var t=document.createElement("meta");return t.name="monetization",t.content=r,document.head.appendChild(t),t}(t);return r}(document.querySelector('meta[name="monetization"]'),r)}function n(r){t(r)}var e="Fundme.js: default address not found. Use setDefaultAddress(str: string) to set it first.",a="Fundme.js: Invalid Web Monetization pointer address is given.",i="Fundme.js: address not found.",o="Fundme.js: address must be a string.";var u="Fundme.js: no monetization template is found.",s="Fundme.js: fails to parse address from <template data-fund></template>.",d="Fundme.js: cannot parse JSON from <script fundme>. Make sure it contains a valid JSON.",f="Fundme.js: found <script fundme> but it's not an array.",c=5;function l(r){t(function(r){var t=r.address;if(!t)throw new Error(i);if("string"!=typeof t)throw new Error(o);return t}(function(r){var t=function(r){return Math.random()*r}(function(r){var t=r.map(function(r){return r.weight});return Object.values(t).reduce(function(r,t){return r+t},0)}(r));return function(r,t){for(var n in r)if((t-=r[n].weight)<=0)return r[n]}(r,t)}(m(r))))}function m(r){return r.map(function(r){if("string"==typeof r&&(r={address:r,weight:c}),!("address"in r))throw new Error(i);return h(r)})}function h(r){return void 0!==r.weight&&NaN!==r.weight||(console.warn("Fundme.js: "+r.address+" has weight that is not a number. It has been set to "+c+" (default)."),r.weight=c),r}var v="template[data-fund]",w="script[fundme]";function g(){var r=[].concat(_toConsumableArray(function(){var r=document.body.querySelectorAll(v),t=[];r.length>0&&r.forEach(function(r){var n=function(r){var t=r.dataset.fund,n=void 0!==r.dataset.fundWeight?parseInt(r.dataset.fundWeight,0):c;if(!t)throw new Error(s);return h({address:t,weight:n})}(r);t=[].concat(_toConsumableArray(t),[n])});return t}()),_toConsumableArray(function(){var r=document.body.querySelectorAll(w),t=[];r.length>0&&r.forEach(function(r){t=function(r){var t=[];try{t=JSON.parse(r.innerHTML)}catch(r){throw new Error(d)}if(!Array.isArray(t))throw new Error(f);t=m(t);return t}(r)});return t}()));if(r.length>1)l(r);else{if(1!==r.length)throw new Error(u);n(r[0].address)}}var p,y=void 0;function A(r){return r}return function(r){r.isSingle="single",r.isMultiple="multiple",r.isDefault="default",r.isFromTemplate="template",r.isUndefined="undefined"}(p||(p={})),r.fund=function(r,t){if("string"==typeof r){if("default"===r){if(void 0!==y)return"string"==typeof y?n(y):l(y),A(p.isDefault);throw new Error(e)}return n(r),A(p.isSingle)}if(i=r,Array.isArray(i))return l(r),A(p.isMultiple);var i;if(void 0===r)return g(),A(p.isFromTemplate);throw new Error(a)},r.setDefaultAddress=function(r){y=Array.isArray(r)?m(r):r},r}({});
