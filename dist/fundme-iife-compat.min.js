"use strict";function _toConsumableArray(n){if(Array.isArray(n)){for(var t=0,r=Array(n.length);t<n.length;t++)r[t]=n[t];return r}return Array.from(n)}var fundme=function(n){function t(n){return function(n,t){n?n.content=t:n=function(n){var t=document.createElement("meta");return t.name="monetization",t.content=n,document.head.appendChild(t),t}(t);return n}(document.querySelector('meta[name="monetization"]'),n)}function r(n){t(n)}var e="Fundme.js: default address not found. Use setDefaultAddress(str: string) to set it first.",o="Fundme.js: Invalid Web Monetization pointer address is given.",a="Fundme.js: address not found.",i="Fundme.js: address must be a string.";var u="Fundme.js: no monetization template is found.",s="Fundme.js: fails to parse address from <template data-fund></template>.",f="Fundme.js: cannot parse JSON from <script fundme>. Make sure it contains a valid JSON.",d="Fundme.js: found <script fundme> but it's not valid.",c='Fundme.js: found <script fundme> but its type is not "application/json"',l=5;function m(n){t(function(n){var t=n.address;if(!t)throw new Error(a);if("string"!=typeof t)throw new Error(i);return t}(function(n){var t=function(n){return Math.random()*n}(function(n){var t=n.map(function(n){return n.weight});return Object.values(t).reduce(function(n,t){return n+t},0)}(n));return function(n,t){for(var r in n)if((t-=n[r].weight)<=0)return n[r]}(n,t)}(p(n))))}function p(n){return n.map(function(n){if("string"==typeof n&&(n=v(n)),!("address"in n))throw new Error(a);return h(n)})}function h(n){return void 0!==n.weight&&NaN!==n.weight||(console.warn("Fundme.js: "+n.address+" has weight that is not a number. It has been set to "+l+" (default)."),n.weight=l),n}function v(n){var t=n,r=void 0,e=n.split("#");return e.length>1&&(t=e[0],r=parseInt(e[1],10)),{address:t,weight:r||l}}var y="template[data-fund]",g="template[fundme]",w="script[fundme]";function A(){var n=[].concat(_toConsumableArray(function(){var n=document.body.querySelectorAll(y),t=[];n.length&&n.forEach(function(n){var r=function(n){var t=n.dataset.fund,r=void 0!==n.dataset.fundWeight?parseInt(n.dataset.fundWeight,0):l;if(!t)throw new Error(s);return h({address:t,weight:r})}(n);t=[].concat(_toConsumableArray(t),[r])});return t}()),_toConsumableArray(function(){var n=document.body.querySelectorAll(w),t=[];n.length&&n.forEach(function(n){t=function(n){var t=[],r=void 0;try{r=JSON.parse(n.innerHTML)}catch(n){throw new Error(f)}if("application/json"!==n.type)throw new Error(c);if(Array.isArray(r))t=p(r);else{if("string"!=typeof r)throw new Error(d);t=p([r])}return t}(n)});return t}()),_toConsumableArray(function(){var n=document.querySelectorAll(g),t=[];n.length&&n.forEach(function(n){t=[].concat(_toConsumableArray(t),_toConsumableArray(function(n){var t=[];return n.innerHTML.split(";").forEach(function(n){var r=n.replace(/(^\s+|\s+$)/g,"");r&&(t=[].concat(_toConsumableArray(t),[v(r)]))}),t}(n)))});return t}()));if(!n.length)throw new Error(u);m(n)}var b,E=void 0;function j(n){return n}return function(n){n.isSingle="single",n.isMultiple="multiple",n.isDefault="default",n.isFromTemplate="template",n.isUndefined="undefined"}(b||(b={})),n.fund=function(n,t){if("string"==typeof n){if("default"===n){if(void 0!==E)return"string"==typeof E?r(E):m(E),j(b.isDefault);throw new Error(e)}return r(n),j(b.isSingle)}if(a=n,Array.isArray(a))return m(n),j(b.isMultiple);var a;if(void 0===n)return A(),j(b.isFromTemplate);throw new Error(o)},n.setDefaultAddress=function(n){E=Array.isArray(n)?p(n):n},n}({});
